## Compilation of Nov Months TILs (Today I Learned)

### Last Quarter Recap:
This is a quick context of what happened over a last few months, mentioning recent ones in details, older just listed... Starting with the major things I'm much proud of:
- Working around `Observability`, esp, Instrumenting K8s services & Lambdas through `Logs & Traces`, using `OpenTelemetry`, other CNCF projects; With an aim of Standardizing instrumentation for all the microservices across platforms with least amount of code changes for it's adoption

This involved with me starting to learn what is instrumentation & significance of `MELT (Metrics, Events, Logs, Traces)` for a service, diving into popular available tools & practices for observability stack, how are traces captured on ground level & industry standards & specs, Opentelemetry spec, **Context propagation** mechanism - B3 headers, Zone JS, etc
- For `Logging` Needs: **fluentbit/fluent d/logstash** to filter & send logs to backends like **ElasticSearch** along with `indexing` strategies & life-cycle management
- **winston** to enable log levels, transformation; **ts-logs** & other libraries performance comparison helping in **masking** logs' sensitive data & auto-generating the error stack trace/source in node-js type of services
- For `Tracing`: learning what calls could be instrumented, how to write custom hooks, enable/disable/sample traces: Generate trace via **auto-instrumentation** packages, **Otel sdk**, Collecting & Sampling via **OTel Collector**, Tracing Backends like **Elastic APM**, **Jaegar**, etc
- For `Metrics`: **kube-state-metrics** auto-gen for k8s based services, other AWS component with enablement of respective **CloudWatch metrics** along with it's periodic aggregation strategies (eg: for lambdas, API gateways, EC2, RDS, etc), `Prometheus` for storing these TSDB metrics, `Grafana` for visualing via dashboarding, `alert-manager` to send slack alerts on anomalies & std metrics rules set

### 1 Nov 2023:
- After all attempts of tracking progress in GitBook, G-Sheets, Notion, etc. restarting here to capture my Tech daily Learnings & Doings.
- Well the day started with me resolving an lambda-logging integration query for user-management service, where in we found that the culprit was the tracing layer that was also introduced along with logging (lambda-logging-arch: for which I had enhanced a node-logging package from js to ts, that standardizes log format & exports to ES, here I had converted sync logger url calls to just a console log which are picked by lambda logging layer with log-extension-api enabled & configured to send the console logs to Elastic search in async way).
- Learning from above was definitely integrating one thing at a time, when incorporating chnages which may break the systems.
- And regarding the actual failure cause: it was because otel sdk package wrapping which we had built our tracing package & AWS layer, was incompatible with lambdas following old style code with fn (event, callback).
- This was actually a known issue & documented, but missed while incorporating the change. Doc Learnings: highlight potential breaking changes at the beginning of integration docs itself, so that it saves the code & debug efforts!
- Then on, some learnings around putting structured milestone based approach when dealing with ambiguous large chunk of work during refinement calls; so that we don't fall into rabbithole of repeatedly navigating & updating original epic... Iykyk - XD
- Then some deep R&D work regarding learning of fetching/scraping of istio metrics with prometheus, conditionally dropping/keeping using relabel/regex strategies - in regards to the dropping of all istio metrics on droppping mountpoint label issue..
- Ref Links: https://meteatamel.wordpress.com/2019/01/07/application-metrics-in-istio/, https://medium.com/quiq-blog/prometheus-relabeling-tricks-6ae62c56cbda, learnt more abt default & most probable configured prom scraping jobs & Drop unnecessary metrics/ time-series (metrics with the specific labels)/ sensitive or unwanted labels/ Amend label format of the final metrics.., https://medium.com/@emirmujic/collect-cluster-and-istio-metrics-with-prometheus-operator-42d4499d621a (basic enablement)
